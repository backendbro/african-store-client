<!DOCTYPE html>
<html class="no-js skrollr skrollr-desktop" lang="en">
  <head>
    <title>Home - African Store</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="author" content="" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <meta name="description" content="African store demo." />

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- favicon icon -->
    <link rel="shortcut icon" href="./store/images/favicon.png" />
    <link
      rel="apple-touch-icon"
      href="./store/images/apple-touch-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="./store/images/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="./store/images/apple-touch-icon-114x114.png"
    />
    <!-- google fonts preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <!-- style sheets and font icons  -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script type="text/javascript" src="./store/js/auth/account.js"></script>

    <link rel="stylesheet" href="./store/css/vendors.min.css" />
    <link rel="stylesheet" href="./store/css/icon.min.css" />
    <link rel="stylesheet" href="./store/css/style.min.css" />
    <link rel="stylesheet" href="./store/css/profile.css" />
    <link rel="stylesheet" href="./store/css/pages.css" />
    <link rel="stylesheet" href="./store/css/responsive.min.css" />
    <link
      rel="stylesheet"
      href="./store/demos/fashion-store/fashion-store.css"
    />
    <link rel="stylesheet" href="./store/css/clasess.scss" />
    <link
      href="https://cdn.shopify.com/shopifycloud/customer-account-web/production/assets/latest/vendors-node_modules_shopify_admin-graphql-api-utilities_build_esnext_index_esnext-node_modul-36cffc-ffec051124c8b592e44f.css"
      crossorigin="anonymous"
      integrity="sha384-5CxZVXGQZxDErc50h165bUCAQpsPVZ48x4/DQc/Bg8K7J7c9Xsi+3AvAFiKDy8OC"
      rel="stylesheet"
    />

    <link
      href="https://cdn.shopify.com/shopifycloud/customer-account-web/production/assets/latest/main-3724eaee40ba8235192d.css"
      crossorigin="anonymous"
      integrity="sha384-SFIcph7hGPoJZbFhNYlb7800k1k58gQ08d2v3Y8FMuBHlIPxa/IW8S/FmNM3l4AN"
      rel="stylesheet"
    />

    <script type="application/ld+json">
       {
          "@context": "https://schema.org/",
         "@type": "WebSite",
          "url": "https://Africanmarkets.eu/",
          "name": "African market lithuania",
          "description": "African Market Lithuania is your go-to store for authentic African food products,
          groceries, and essentials in Lithuania. We offer a wide range of high-quality African spices, grains,
           beverages, and more, bringing the rich flavors of Africa to your doorstep.
          Shop online or visit us for fresh, handpicked ingredients that celebrate African culinary traditions.",
          "publisher": {
              "@type": "Organization",
              "name": "African market lithuania",
              "url": "https://Africanmarkets.eu/",
              "logo": "https://Africanmarkets.eu/store/images/apple-touch-icon-72x72.png"
          }
      }
    </script>

    <script type="application/ld+json">
      {
        "@context": "https://schema.org/",
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://Africanmarkets.eu/"
          }
        ]
      }
    </script>
  </head>

  <style>
    .profile-img-container {
      position: relative;
      display: inline-block;
      cursor: pointer;
    }

    .profile-img-container {
      position: relative;
      cursor: pointer;
    }

    /* Spinner overlay styles */
    .spinner-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.8); /* Semi-transparent white overlay */
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }

    /* Spinner animation */
    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #3498db;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }

    .profile-img-container img {
      width: 120px; /* Adjust as needed */
      height: 120px; /* Adjust as needed */
      border-radius: 50%;
      transition: opacity 0.3s ease-in-out;
    }

    /* Hover effect */
    .profile-img-container:hover img {
      opacity: 0.7;
    }

    /* Edit icon overlay */
    .profile-img-container::after {
      content: "Edit";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.6);
      color: white;
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 14px;
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }

    .profile-img-container:hover::after {
      opacity: 1;
    }

    .loading-spinner {
      border: 2px solid #f3f3f3;
      border-top: 2px solid #3498db;
      border-radius: 50%;
      width: 14px;
      height: 14px;
      animation: spin 1s linear infinite;
      display: inline-block;
      vertical-align: middle;
      margin-right: 5px;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }
  </style>
  <body data-mobile-nav-style="classic">
    <!-- start header -->
    <header class="header-with-topbar">
      <!-- start header top bar -->
      <div
        class="header-top-bar top-bar-light disable-fixed md-border-bottom border-color-transparent-dark-very-light"
      >
        <div class="container-fluid">
          <div class="row h-40px align-items-center m-0">
            <div
              class="col-12 justify-content-center alt-font fs-13 fw-500 text-uppercase"
            >
              <div class="advert">
                Enjoy FREE standard delivery on orders over €100
              </div>
              <a
                href="./store/shop-page/shop.html"
                class="advert fw-600 ms-5px advert-hover"
              >
                <span class="text-decoration-line-bottom">Shop now</span>
              </a>
            </div>
          </div>
        </div>
      </div>
      <!-- end header top bar -->
      <!-- start navigation -->
      <nav
        class="navbar navbar-expand-lg header-light bg-white disable-fixed center-logo"
      >
        <div class="container-fluid">
          <div class="col-auto col-xxl-3 col-lg-2 menu-logo">
            <div class="header-icon d-none d-lg-flex">
              <div class="widget-text icon alt-font">
                <a
                  href="https://maps.app.goo.gl/SHNZXP9ptSGASVYu7
                "
                >
                  <i
                    class="feather icon-feather-map-pin d-inline-block me-5px"
                  ></i>
                  <span class="d-none d-xxl-inline-block"></span>
                </a>
              </div>
              <div class="widget-text icon alt-font">
                <a
                  href="https://www.instagram.com/african_market_lt?igsh=ZTQyc3JhcjVodGYw"
                  target="_blank"
                >
                  <i
                    class="feather icon-feather-instagram d-inline-block me-5px"
                  ></i>
                  <span class="d-none d-xxl-inline-block"></span>
                </a>
              </div>
            </div>
            <a class="navbar-brand" href="./index.html">
              <img
                src="./store/images/store-logo-1.png"
                data-at2x="./store/images/store-logo-1.png"
                alt=""
                class="default-logo"
              />
              <img
                src="./store/images/store-logo-1.png"
                data-at2x="./store/images/store-logo-1.png"
                alt=""
                class="alt-logo"
              />
              <img
                src="./store/images/store-logo-1.png"
                data-at2x="./store/images/store-logo-1.png"
                alt=""
                class="mobile-logo"
              />
            </a>
          </div>
          <div class="col-auto col-xxl-6 col-lg-8 menu-order">
            <button
              class="navbar-toggler float-end"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNav"
              aria-controls="navbarNav"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-line"></span>
              <span class="navbar-toggler-line"></span>
              <span class="navbar-toggler-line"></span>
              <span class="navbar-toggler-line"></span>
            </button>
            <div
              class="collapse navbar-collapse justify-content-between"
              id="navbarNav"
            >
              <ul class="navbar-nav alt-font navbar-left justify-content-end">
                <li class="nav-item">
                  <a href="./index.html" class="nav-link">Home</a>
                </li>
              </ul>
              <ul
                class="navbar-nav alt-font navbar-right justify-content-start"
              >
                <li class="nav-item">
                  <a href="./store/shop-page/shop.html" class="nav-link"
                    >Shop</a
                  >
                </li>
              </ul>
            </div>
          </div>
          <div class="col-auto col-xxl-3 col-lg-2 text-end">
            <div class="header-icon">
              <div class="header-search-icon icon alt-font">
                <div class="search-form-wrapper"></div>
              </div>

              <div class="header-account-icon icon alt-font">
                <div class="header-account dropdown">
                  <a href="javascript:void(0);" class="fw-500">
                    <i
                      class="feather icon-feather-user d-inline-block me-5px"
                    ></i>
                    <span class="d-none d-xxl-inline-block">Account</span>
                  </a>
                  <ul class="account-item-list">
                    <li class="account-item">
                      <a href="/user-dasboard.html">My profile</a>
                    </li>
                    <li class="account-item">
                      <a href="/account.html">Login/Sign up</a>
                    </li>

                    <li class="account-item">
                      <a href="#" style="color: red">Logout</a>
                    </li>
                  </ul>
                </div>
              </div>

              <div class="header-cart-icon icon">
                <div class="header-cart dropdown">
                  <a href="javascript:void(0);">
                    <i class="feather icon-feather-shopping-bag"></i>
                    <span class="cart-count alt-font text-white bg-dark-gray"
                      >2</span
                    >
                  </a>
                  <ul class="cart-item-list">
                    <li class="cart-total">
                      <div class="fs-18 alt-font mb-15px">
                        <span class="w-50 fw-500 text-start">Subtotal:</span>
                        <span class="w-50 text-end fw-700">€0.00</span>
                      </div>
                      <a
                        href="./cart.html"
                        class="btn btn-large btn-transparent-light-gray border-color-extra-medium-gray"
                        >View cart</a
                      >
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
    </header>
    <!-- end header -->
    <div class="container">
      <header>
        <h2 class="my-profile">
          My
          <span class="text-highlight fw-600">
            Profile<span class="text-underline h-5px bottom-2px"></span>
          </span>
        </h2>
      </header>

      <div class="profile-section">
        <div
          class="profile-img-container"
          onclick="document.getElementById('imageUpload').click()"
        >
          <img id="profile-img-display" src="" alt="Profile Picture" />
          <input
            type="file"
            id="imageUpload"
            style="display: none"
            onchange="uploadImage(event)"
          />
        </div>
        <div class="user-info">
          <p id="user-name">
            &nbsp;
            <button onclick="showEditPopup()">Edit ✏️</button>
          </p>
          <p id="user-email"></p>
        </div>
      </div>
    </div>

    <!-- Edit Profile Popup -->
    <!-- <div class="popup" id="edit-popup">
      <div class="popup-content">
        <h3>Edit Profile</h3>
        <input type="text" id="first-name" placeholder="First Name" />
        <input type="text" id="last-name" placeholder="Last Name" />
        <input type="text" id="username" placeholder="Username" />
        <input type="email" id="email" placeholder="Email" />
        <input type="password" id="password" placeholder="New password" />
        <div class="popup-buttons">
          <button onclick="saveChanges()">Save Changes</button>
          <button onclick="closePopup()">Cancel</button>
        </div>
      </div>
    </div> -->

    <div class="popup" id="edit-popup">
      <div class="popup-content">
        <h3>Edit Profile</h3>
        <!-- New username field -->
        <input type="text" id="first-name" placeholder="First Name" />
        <input type="text" id="last-name" placeholder="Last Name" />
        <input type="email" id="email" placeholder="Email" />
        <input type="text" id="username" placeholder="Username" />
        <input type="password" id="password" placeholder="New password" />
        <div class="popup-buttons">
          <!-- Save changes button with an id for updating its content -->
          <button id="save-changes-btn" onclick="saveChanges()">
            Save Changes
          </button>
          <button onclick="closePopup()">Cancel</button>
        </div>
      </div>
    </div>

    <a href="https://wa.link/835yqh" class="float" target="_blank">
      <i class="fab fa-whatsapp my-float"></i>
    </a>

    <!-- <script>
      function toggleDropdown() {
        document.getElementById("dropdown-menu").classList.toggle("show");
      }

      document.addEventListener("click", function (event) {
        let dropdown = document.getElementById("dropdown-menu");
        let profileIcon = document.querySelector(".profile-icon");

        if (
          !profileIcon.contains(event.target) &&
          !dropdown.contains(event.target)
        ) {
          dropdown.classList.remove("show");
        }
      });

      function showProfile() {
        alert("Profile clicked");
      }

      function showSettings() {
        alert("Settings clicked");
      }

      function logout() {
        alert("Logged out");
      }

      function uploadImage(event) {
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function (e) {
            document.getElementById("profile-img-display").src =
              e.target.result;
          };
          reader.readAsDataURL(file);
        }
      }

      function showEditPopup() {
        document.getElementById("edit-popup").style.display = "block";
        document.getElementById("overlay").style.display = "block";
      }

      function closePopup() {
        document.getElementById("edit-popup").style.display = "none";
        document.getElementById("overlay").style.display = "none";
      }

      function saveChanges() {
        let firstName = document.getElementById("first-name").value.trim();
        let lastName = document.getElementById("last-name").value.trim();
        if (firstName && lastName) {
          document.getElementById(
            "user-name"
          ).innerHTML = `${firstName} ${lastName} <button onclick="showEditPopup()">✏️</button>`;
        }
        closePopup();
      }
    </script> -->

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Dropdown and other pop-up related functions
        function clearPopupFields() {
          const inputs = document.querySelectorAll("#edit-popup input");
          inputs.forEach((input) => {
            input.value = "";
          });
        }

        function toggleDropdown() {
          const dropdown = document.getElementById("dropdown-menu");
          if (dropdown) {
            dropdown.classList.toggle("show");
          }
        }

        document.addEventListener("click", function (event) {
          const dropdown = document.getElementById("dropdown-menu");
          const profileIcon = document.querySelector(".profile-icon");
          if (dropdown && profileIcon) {
            if (
              !profileIcon.contains(event.target) &&
              !dropdown.contains(event.target)
            ) {
              dropdown.classList.remove("show");
            }
          }
        });

        function showProfile() {
          alert("Profile clicked");
        }

        function showSettings() {
          alert("Settings clicked");
        }

        function logout() {
          alert("Logged out");
        }

        function uploadImage(event) {
          const file = event.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
              const profileImg = document.getElementById("profile-img-display");
              if (profileImg) {
                profileImg.src = e.target.result;
              }
            };
            reader.readAsDataURL(file);
          }
        }

        // Popup functions for editing profile details
        //function showEditPopup() {
        //const editPopup = document.getElementById("edit-popup");
        //if (editPopup) {
        //editPopup.style.display = "block";
        //} else {
        //console.error("Edit popup element not found.");
        //}
        //}

        function showEditPopup() {
          const editPopup = document.getElementById("edit-popup");
          if (editPopup) {
            clearPopupFields(); // Clear fields before showing the popup
            editPopup.style.display = "block";
          } else {
            console.error("Edit popup element not found.");
          }
        }

        //function closePopup() {
        //const editPopup = document.getElementById("edit-popup");
        //if (editPopup) {
        //editPopup.style.display = "none";
        //} else {
        //console.error("Edit popup element not found.");
        //}
        //}

        function closePopup() {
          const editPopup = document.getElementById("edit-popup");
          if (editPopup) {
            editPopup.style.display = "none";
          } else {
            console.error("Edit popup element not found.");
          }
        }

        // Updated saveChanges function with loading spinner and username field
        async function saveChanges() {
          const usernameElem = document.getElementById("username");
          const firstNameElem = document.getElementById("first-name");
          const lastNameElem = document.getElementById("last-name");
          const emailElem = document.getElementById("email");
          const passwordElem = document.getElementById("password");
          const saveBtn = document.getElementById("save-changes-btn");

          if (
            !usernameElem ||
            !firstNameElem ||
            !lastNameElem ||
            !emailElem ||
            !passwordElem ||
            !saveBtn
          ) {
            console.error("One or more input elements not found.");
            return;
          }

          const username = usernameElem.value.trim();
          const firstName = firstNameElem.value.trim();
          const lastName = lastNameElem.value.trim();
          const email = emailElem.value.trim();
          const password = passwordElem.value.trim();
          const token = localStorage.getItem("token");

          // Create an object with the updated fields
          const updatedData = {
            username,
            firstName,
            lastName,
            email,
            password,
          };
          // Remove any keys with empty values
          Object.keys(updatedData).forEach((key) => {
            if (!updatedData[key]) delete updatedData[key];
          });

          // Show loading spinner on the save button
          const originalBtnText = saveBtn.innerHTML;
          saveBtn.disabled = true;
          saveBtn.innerHTML = `<span class="loading-spinner"></span> Saving...`;

          try {
            const response = await fetch(
              "https://african-store.onrender.com/api/v1/auth/profile",
              {
                method: "PUT",
                headers: {
                  "Content-Type": "application/json",
                  Authorization: `Bearer ${token}`,
                },
                body: JSON.stringify(updatedData),
              }
            );

            const data = await response.json();

            if (response.ok) {
              Swal.fire({
                title: "Success",
                text: "Profile updated successfully!",
                icon: "success",
                showConfirmButton: false,
                timer: 2000,
              });
              // Optionally update the UI with the new username
              if (data.data && data.data.username) {
                const userNameElem = document.getElementById("user-name");
                if (userNameElem) {
                  userNameElem.innerHTML = `${data.data.username} <button onclick="showEditPopup()">✏️</button>`;
                }
              }
              closePopup();
            } else {
              Swal.fire({
                title: "Error",
                text: data.message || "Failed to update profile",
                icon: "error",
              });
            }
          } catch (error) {
            console.error("Error updating profile:", error);
            Swal.fire({
              title: "Error",
              text: error.message,
              icon: "error",
            });
          } finally {
            // Re-enable the button and restore its text
            saveBtn.disabled = false;
            saveBtn.innerHTML = originalBtnText;
          }
        }

        // Expose functions globally for inline event handlers
        window.toggleDropdown = toggleDropdown;
        window.showProfile = showProfile;
        window.showSettings = showSettings;
        window.logout = logout;
        window.uploadImage = uploadImage;
        window.showEditPopup = showEditPopup;
        window.closePopup = closePopup;
        //window.showEditPopup = showEditPopup;
        //window.closePopup = closePopup;
        window.saveChanges = saveChanges;
      });
    </script>

    <script src="/store/js/auth/account.js"></script>
    <script src="/store/js/auth/dashboard.js"></script>
    <script src="/store/js/shop/cart.js"></script>
    <script src="/store/js/auth/upload.js"></script>

    <!-- javascript libraries -->
    <script src="./store/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
    <script type="text/javascript" src="./store/js/jquery.js"></script>
    <script type="text/javascript" src="./store/js/vendors.min.js"></script>
    <script type="text/javascript" src="./store/js/main.js"></script>
  </body>
</html>
